## 02.컴퓨터 비전 소개
- 컴퓨터 비전은 크게 이미지의 내용을 분석하고, 이미지에 해당되는 레이블을 찾거나, 이미지 속에 항목을 찾는 작업들을 말합니다.
- 컴퓨터가 이 미지의 픽셀을 해석하는 구조화된 알고리즘을 말합니다.
- 이미지의 수많은 패턴을 찾아서 조합하여 또 다른 패턴을 찾을 수 있는 방법이라 생각 합니다. 
- 이미지를 이해한다기보다는 이미지의 패턴을 잘 찾을 수 있다는 의미로 이해하면 좋습니다.
- 머신러닝을 활 용하면 단 몇 줄의 코드로 이미지의 내용을 해석할 수 있는 모델을 만들 수 있습니다.

### 비전을 위한 뉴런 사용하기
<img width="213" alt="스크린샷 2023-02-19 오후 3 14 56" src="https://user-images.githubusercontent.com/49600974/219932269-1b439490-27f3-4a6e-aa4b-4a1dda811572.png">

- Sequential 안에 쉼표를 기준으로 레이어들을 나열하면 쉽게 정의할 수 있습니다.
- 출력은 뉴런 하나이고 이 뉴 런은 하나의 가중치와 하나의 편향만을 학습하게 됩니다.
- 아주 단순한 이미지라 하더라도 하나 의 값만으로 표현하기에는 일반적인 이미지에는 너무 많은 내용을 담고 있으므로 이 뉴런 하나 만으로 이미지 내용을 잘 이해하는 데는 무리가 있습니다.


<img width="354" alt="스크린샷 2023-02-19 오후 3 16 20" src="https://user-images.githubusercontent.com/49600974/219932319-d131bbd1-12fd-4dde-8b62-604050f15506.png">

- 출력 뉴런을 우리가 구별하고 싶은 여러 클래스에 지정하면 어떨까요?
- 이것과 같은 방식으로 이미지를 해석하는 법을 배울 때도 컴 퓨터가 이해할 수 있는 항목의 개수를 제한하는 것이 좋습니다.
- 보통 여기서 클래스class라는 용어를 사용합니다.
- 이 작업을 보통 이미지 분류image classification라고 부릅니다.
- 우리의 모델은 편의상 분류기classifier라고 부르겠습니다.
- 두 뉴런의 결괏값은 강아지와 고양이를 의미하며 이를 통해 이미지를 ‘본다’고 할 수 있습 니다.
- 클래스를 표현하는 출력 뉴런(예를 들어 토끼)을 추가해주기만 하면 됩니다.

<img width="348" alt="스크린샷 2023-02-19 오후 3 17 39" src="https://user-images.githubusercontent.com/49600974/219932368-8011b895-347e-449c-b6ad-022b47608215.png">

- 해결 방법은 모델이 학습되는 동안에만 이런 데이터 를 저장하고, 끝나고 나면 바로 버리는 것입니다.
- 만약 우리가 여러 강아지와 고양이 이미지를 가지고 있다면 각 이미지를 적절하게 레이블링하고, 시간이 지나면서 신경망이 입력 이미지에 대해 적절한 레이블을 맞춰서 우리가 달아놓은 레이블값과 비슷한 출력을 만들어내 게 됩니다.
- 사실 큰 차이가 없이 단순히 확률의 출력값을 얻을 뿐입니다.

<img width="225" alt="스크린샷 2023-02-19 오후 3 18 23" src="https://user-images.githubusercontent.com/49600974/219932398-d668a3e4-984d-4212-aa1e-caa4c7e75e18.png">

- 애플리케이션이 추출한 특징 중에 사과나 무화과와 유사한 부 분도 있기 때문입니다(색깔이나 표면 질감 같은 것들).
- 모델이 제대로 판단할 수 있게 학습시키려면 수많은 이미지와 각 이미지별 적절한 클래스가 달린 레이블링을 제공해야 합니다.

### 첫 분류기: 의류 구별하기
- 어떤 경우는 규칙만으로 표현하 기가 불가능할 수도 있습니다.
- 우리는 여러 예시를 보면서 어떻게 사용하는지 경험을 통해 배웠습니다.

### 데이터: 패션 MNIST
- 패션 MNIST에는 기존 MNIST에 있는 0에서 9까지의 숫자 이미지 대신, 10가지 다른 종류의 의류 이미지가 들어 있습니다.

### 패션 MNIST 모델 아키텍처
<img width="407" alt="스크린샷 2023-02-19 오후 3 20 52" src="https://user-images.githubusercontent.com/49600974/219932490-e840b9cf-10b6-4d6a-b4ef-a335bd4efe95.png">

- 패션 MNIST에 10가지 의류 클래스가 있으 므로 우리는 10개 뉴런을 가지는 출력 레이어가 필요합니다.
- 하지만 이미지 픽셀을 변환해 뉴런에 넣는다는 점을 기억해주세요.
- 우리 이미지는 28 × 28 픽셀 크기(2차원 배열)의 정사각형이므로 이미지를 입력 레이어의 뉴런이 표현하는 방식(1차원 배열)으로 만들어줘야 합니다.
- 분류에서의 정확도와 손실값은 옵티마이저가 뉴런값을 조금씩 조정하는데 사용되고, 이 과정을 계속 반복합니다.

### 패션 MNIST 모델 코딩
<img width="189" alt="스크린샷 2023-02-19 오후 3 22 00" src="https://user-images.githubusercontent.com/49600974/219932525-bd89e733-d072-4de1-948a-b60fdf340b17.png">

- 모델 아키텍처를 정의할 수 있을 뿐만 아니라, 레이어의 기능을 캡슐화할 수도 있습니다.

<img width="215" alt="스크린샷 2023-02-19 오후 3 22 52" src="https://user-images.githubusercontent.com/49600974/219932557-49a1a213-8c60-4cff-ad94-1bf3a4115a6d.png">

- 여기서 activation 파라미터는 활성함수를 정의하는 파라미터입니다.
- 활성함수는 레이어 뒤 에 붙어서 실행되고 신경망이 복잡한 패턴을 구별하는 데 도움이 됩니다.
- 레이어에서 레이어로 정보가 이동할때 작동방식을 변경하여 학습을 더 잘하고 빠르게 할 수 있도록 도와줍니다.

<img width="110" alt="스크린샷 2023-02-19 오후 3 23 37" src="https://user-images.githubusercontent.com/49600974/219932577-a0af66f7-e888-49f2-ad1b-d4d1e4b85001.png">

- 이전 레이어에서 어떤 뉴런이 음수를 반환한다면 다른 뉴런의 양수값을 상쇄시켜버려서 학습된 내용을 무시하게 될 수도 있습니다. 
- 물론 현실에서는 이 렇게 이상적으로 되기 쉽지 않으며, 각 뉴런이 각기 다른 값을 가집니다.
- 하지만 이 값을 확률로 보기 위해서 뉴런의 값을 적절히 조정해서 다 합쳤을 때 1로 만들어야 합니다.


<img width="488" alt="스크린샷 2023-02-19 오후 3 24 08" src="https://user-images.githubusercontent.com/49600974/219932600-012d6ae6-954f-43d5-a7a0-7bc3e70af953.png">

- val 데이터는 학습시키는 동안에는 사용하지 않으며, 신경망이 한 번도 보지 못했던 데이터로써 성능을 평가할 때 사용합니다.

<img width="280" alt="스크린샷 2023-02-19 오후 3 24 31" src="https://user-images.githubusercontent.com/49600974/219932612-99fdcefb-0105-422c-b1c2-b7e7be7ad6c7.png">

- 왜냐면 이미지의 픽셀값이 0에서 255로 이루어져 있으므로 255로 나누어서 0에서 1의 사잇값 으로 만들어주는 겁니다.
- 정규화는 오류가 너무 커져버려서 학습이 되지 않는 문제를 예방하는데 도움이 됩니다.

<img width="480" alt="스크린샷 2023-02-19 오후 3 25 25" src="https://user-images.githubusercontent.com/49600974/219932644-a303f3b6-dbb0-4d75-9b48-d2d937e8e22a.png">

- 텐서플로에는 이런 함수들을 정의해놓은 라이브러리가 있습니다.
- 일반적으로 개발자들은 이런 함수들을 골라 실험하고, 모델에 가장 좋은 기능이 무엇인지 찾습니다. 
- 이 파라미터는 학습되는 동안 텐서 플로에 정확도를 알려줍니다.
- 컴파일 시점에 지표를 지정하여 텐서플로가 학습을 진행 하는 동안 사용할 수 있게 설정합니다.
-  adam은 보통 빠르게 학습되고, sgd는 조금 느린 경향이 있어 캐글 대회에서는 참가자들은 adam으로 서브실험들을 한 뒤, 마지막에는 sgd로 최고 성능을 뽑는 경향이 있다고 합니다.

<img width="484" alt="스크린샷 2023-02-19 오후 3 26 43" src="https://user-images.githubusercontent.com/49600974/219932683-62a5a73b-d0ca-4f8f-954d-70461907ce0a.png">

- 텐서플로는 배치 기능으로 모델이 여러 이미지를 한 번에 보게 하여 더 빠르게 학습시킬 수 있습니다.

<img width="480" alt="스크린샷 2023-02-19 오후 3 27 02" src="https://user-images.githubusercontent.com/49600974/219932694-c694ed39-42ed-4e50-8a2f-7824b54b5d21.png">

- model.evaluate를 호출할 때 검증셋의 이미지와 레이블을 전달합니다.
- 머신러닝에서 과적합overfitting 현상은 모델이 학습셋은 잘 판단해내지만, 처음 보는 데이터 는 잘 판단하지 못하는 현상을 말합니다.
- 이는 학습셋의 정확도와 검증셋의 정확도가 크게 차 이가 났을 때 파악할 수 있습니다.
- 이때는 ‘합성곱 신경망convolutional neural network’를 사용하면 됩니다.

### 컴퓨터 비전을 위한 전이 학습
- 그럼 좀 더 큰 이미지, 더 많은 클래스, 색상, 다른 것들 이 추가된다면? 이를 위해서는 훨씬 더 복잡한 아키텍처를 만들어야만 합니다.
- 이름에서 알 수 있듯, 모바일 친화적이고, 적은 배터리 소모량에 높은 성능을 내도록 설계된 모델 아키텍처입니다.
- 이 벡터로 1,000개의 클래스를 분류해 레이어로 전달하는 MobileNet 모델을 설계할 수 있습니다.
- MobileNet 같은 모델은 수천 클래스를 가진 이미지 10만 장으로 학습하는 과정을 거쳤기 때 문에 일반적인 이미지에서도 좋은 성능을 낼 수 있습니다.
- MobileNet에 출력 뉴런 3개를 붙여서, 사전학습된 MobileNet의 1,280개 특징 벡터를 이용하고 마지막 레이어를 통해 3개의 클래스로만 구별하도록 만들면 됩니다.

<img width="480" alt="스크린샷 2023-02-19 오후 3 28 26" src="https://user-images.githubusercontent.com/49600974/219932752-5f1452b8-8a8a-4921-b345-7d6b0973f0c7.png">

- 여기서 자세하게 다루지는 않겠지만 224는 우리가 사용하고 싶은 모델의 이 미지 입력 크기를 나타냅니다.


<img width="479" alt="스크린샷 2023-02-19 오후 3 28 42" src="https://user-images.githubusercontent.com/49600974/219932764-1f561594-fe93-4258-9dee-b49766076257.png">

- 첫 번째 줄의 trainable=False 설정은, 학습된 모델의 파라미터를 재사용하되 사전학습된 값 들은 수정하지 않는다는 의미입니다.
- 이미 MobileNet과 ImageNet을 통해 몇 시간 동안 이미 학습된 것들이 준비되어 있으므로 우리는 다시 처음부터 모델을 학습시킬 필요가 없 습니다.

### 마치며
- 이미 학습된 파라미터를 다양한 시나리오에서 쉽게 사 용할 수 있는 전이 학습에 대한 개념을 소개하였습니다.
- 이 책은 모바일 애플리케이션에서 사용할 모델에 초점을 두기 때문에 이번 장에서 소개한 방법 들을 주로 사용합니다.








